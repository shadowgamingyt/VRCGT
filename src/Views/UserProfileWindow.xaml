<Window x:Class="VRCGroupTools.Views.UserProfileWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="clr-namespace:VRCGroupTools.ViewModels"
        xmlns:converters="clr-namespace:VRCGroupTools.Converters"
        mc:Ignorable="d"
        Title="User Profile" Height="450" Width="400"
        WindowStartupLocation="CenterScreen"
        ResizeMode="NoResize"
        Background="#1E1E1E">
    
    <Window.Resources>
        <converters:BoolToVisibilityConverter x:Key="BoolToVis"/>
        <converters:InverseBoolToVisConverter x:Key="InverseBoolToVis"/>
    </Window.Resources>

    <Grid>
        <!-- Loading State -->
        <Grid Visibility="{Binding IsLoading, Converter={StaticResource BoolToVis}}" 
              Panel.ZIndex="10" 
              Background="#80000000">
            <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                <TextBlock Text="Loading..." Foreground="White" FontSize="16"/>
            </StackPanel>
        </Grid>

        <Border Padding="20">
            <StackPanel>
                <!-- Header: Profile Pic & Name -->
                <Grid Margin="0,0,0,20">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <Border Grid.Column="0" Width="80" Height="80" CornerRadius="40" ClipToBounds="True" BorderBrush="White" BorderThickness="2" Margin="0,0,15,0">
                         <Border.Background>
                             <ImageBrush ImageSource="{Binding User.ProfilePicUrl}" Stretch="UniformToFill"/>
                         </Border.Background>
                    </Border>

                    <StackPanel Grid.Column="1" VerticalAlignment="Center">
                        <TextBlock Text="{Binding User.DisplayName}" 
                                   Foreground="White" 
                                   FontSize="24" 
                                   FontWeight="Bold"
                                   TextTrimming="CharacterEllipsis"/>
                        
                        <Border Background="{Binding TrustRankBrush}" 
                                Padding="8,2" 
                                HorizontalAlignment="Left" 
                                CornerRadius="4" 
                                Margin="0,5,0,0">
                            <TextBlock Text="{Binding TrustRank}" 
                                       Foreground="White" 
                                       FontSize="12" 
                                       FontWeight="Bold"/>
                        </Border>
                    </StackPanel>
                </Grid>

                <!-- 18+ Status -->
                <Border Background="#2D2D2D" CornerRadius="5" Padding="10" Margin="0,0,0,10">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="Age Verified:" Foreground="#AAAAAA" Width="100"/>
                        <TextBlock Text="Yes (18+)" Foreground="#2ECC71" FontWeight="Bold" 
                                   Visibility="{Binding User.IsAgeVerified, Converter={StaticResource BoolToVis}}"/>
                         <TextBlock Text="No" Foreground="White" 
                                   Visibility="{Binding User.IsAgeVerified, Converter={StaticResource InverseBoolToVis}}"/>
                    </StackPanel>
                </Border>

                <!-- Bio -->
                <TextBlock Text="Bio" Foreground="#AAAAAA" Margin="0,0,0,5"/>
                <Border Background="#2D2D2D" CornerRadius="5" Padding="10" Height="100">
                    <ScrollViewer>
                        <TextBlock Text="{Binding User.Bio}" Foreground="White" TextWrapping="Wrap"/>
                    </ScrollViewer>
                </Border>

                <!-- Buttons -->
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,20,0,0">
                    <Button Content="Open Web Profile" 
                            Command="{Binding OpenWebProfileCommand}"
                            Background="#34495E" Foreground="White"
                            Padding="15,8" Margin="0,0,10,0" BorderThickness="0"/>
                </StackPanel>
            </StackPanel>
        </Border>
    </Grid>
</Window>